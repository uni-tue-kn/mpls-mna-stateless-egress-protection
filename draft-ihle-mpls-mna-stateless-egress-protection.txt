



Multiprotocol Label Switching                                    F. Ihle
Internet-Draft                                                  M. Menth
Intended status: Standards Track                 University of Tuebingen
Expires: 21 March 2025                                 17 September 2024


                MNA for Stateless MPLS Egress Protection
         draft-ihle-mpls-mna-stateless-egress-protection-latest

Abstract

   The MPLS Network Action (MNA) framework provides a general mechanism
   for the encoding and processing of network actions and their data.

   The MPLS Egress Protection Framework specifies a fast reroute
   mechanism for protecting IP/MPLS services.  To that end backup
   tunnels have to be signaled to the Point of Local Repair (PLR).

   This document defines the encoding for the Stateless MPLS Egress
   Protection (SMEP) network action.  The SMEP network action protects
   egress routers by providing an alternative MPLS egress label in-
   stack.  For SMEP, no signaling of protection tunnels is required.

About This Document

   This note is to be removed before publishing as an RFC.

   The latest revision of this draft can be found at https://uni-tue-
   kn.github.io/mpls-mna-stateless-egress-protection/draft-ihle-mpls-
   mna-stateless-egress-protection.html.  Status information for this
   document may be found at https://datatracker.ietf.org/doc/draft-ihle-
   mpls-mna-stateless-egress-protection/.

   Discussion of this document takes place on the Multiprotocol Label
   Switching Working Group mailing list (mailto:mpls@ietf.org), which is
   archived at https://mailarchive.ietf.org/arch/browse/mpls/.
   Subscribe at https://www.ietf.org/mailman/listinfo/mpls/.

   Source for this draft and an issue tracker can be found at
   https://github.com/uni-tue-kn/mpls-mna-stateless-egress-protection.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 21 March 2025.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Terminology
   2.  MPLS Network Action for Stateless Egress Protection
     2.1.  Encoding
     2.2.  Processing
   3.  Example
   4.  Security Considerations
   5.  IANA Considerations
   6.  References
     6.1.  Normative References
     6.2.  Informative References
   Authors' Addresses

1.  Introduction

   MPLS egress protection in [RFC8679] establishes backup tunnels for
   egress routers on an egress failure, i.e., on a node or a link
   failure.  This is referred to as egress protection.  The protection
   mechanism relies on a Point of Local Repair (PLR) that performs local
   failure detection and local repair.  Usually, this PLR is the
   penultimate router.  On an egress failure, packets are rerouted using
   fast reroute (FRR) to an alternative egress router.  The PLR must
   maintain a list of bypass tunnels and the bypass forwarding state on
   a per-transport-tunnel basis.  The bypass tunnels are signaled using
   existing mechanisms, i.e., via an IGP, or topology-driven label
   distribution protocols such as LDP.

   With the MPLS Network Action (MNA) framework, network actions are
   encoded in the MPLS stack.  [I-D.ietf-mpls-mna-hdr] defines the
   encoding of such network actions and their data in the MPLS stack.
   Those network actions are processed by all nodes on a path (hop-by-
   hop), by only selected nodes, or on an ingress-to-egress basis.

   This document defines the Stateless MPLS Egress Protection (SMEP)
   network action.  With SMEP, egress bypass tunnels are carried in a
   network action in the MPLS stack.  The ingress router pushes the MPLS
   stack containing the SMEP network action.  On an egress failure, the
   bypass MPLS label in the network action is used to protect the egress
   tunnel.  No signaling is required for this approach and no state must
   be kept in the PLR.

1.1.  Terminology

   This document makes use of the terms defined in [RFC8679] and in
   [I-D.ietf-mpls-mna-hdr].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.  MPLS Network Action for Stateless Egress Protection

2.1.  Encoding

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Opcode=SMEP  |    Bypass MPLS Label (BML)    |S|  BML  | NAL=0 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

               Figure 1: MNA for Stateless Egress Protection.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Opcode=SMEP  |    Bypass MPLS Label (BML)    |S|  BML  | NAL=1 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1|00              Bypass MPLS Label (BML)    |S|     Data=0    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 2: MNA for Stateless Egress Protection using a list of
                               bypass labels.

   The network action for stateless MPLS egress protection is encoded as
   follows:

   *  Network Action Indication: The SMEP network action is indicated by
      opcode TBA1.

   *  Format: The SMEP network action MUST be encoded using a Format C
      LSE as defined in [I-D.ietf-mpls-mna-hdr], see Figure 1.
      Optionally, a list of bypass MPLS labels MAY be carried as Format
      D LSE, see Figure 2.

   *  Scope: The SMEP network action is valid only in the select scope.

   *  Ancillary Data: The SMEP network action requires 20 bits of in-
      stack ancillary data to encode the bypass MPLS label.  The most-
      significant 16 bit of the bypass MPLS label are located in the
      first data field of an Format C LSE.  The least-significant 4 bit
      are located in the second datafield of an Format C LSE.  No post-
      stack data is required.  If Format D LSEs are provided, the bypass
      MPLS label is encoded in the least-significant bits of the first
      data field of an Format D LSE.  The two most-significant bits of
      the first data field, and the 8 bits of the second data field MUST
      be set to zero.

2.2.  Processing

   The ingress LER that pushes an SR-MPLS label stack onto a packet
   includes the bypass MPLS label in a network action.  The bypass MPLS
   label encodes the SID to an alternative egress router.  The SMEP
   network action must be placed in the MPLS stack such that the PLR
   (Point of Local Repair), i.e., the penultimate node, is able to
   process the network action.  That means the SMEP network action is
   only processed by the penultimate node using the select scope.  On an
   egress node failure or an egress link failure, the penultimate node
   MUST use the bypass MPLS label to route traffic to an alternative
   egress router.  To that end, the data fields in the Format C LSE of
   the SMEP network actions are concatened to form the 20 bit MPLS
   label.  If a list of bypass MPLS labels is provided as Format D LSEs,
   they are prioritized from top-of-stack to the bottom-of-stack.

3.  Example

   An example topology using MPLS egress protection is shown in
   Figure 3.  Labels A and B are used to forward to the penultimate
   router.  From here, three paths are available to an egress node.
   Labels C, C', and C'' are used to route to one of the egress nodes.
   If the egress link or router C fails, the PLR can use the bypass
   tunnel of router C' and C''.  The MPLS stack encoding this
   functionality is shown in Figure 4.  The Network Action Sub-Stack
   (NAS) for SMEP contains an Format A LSE to indicate the MNA Sub-Stack
   and an Format B LSE.  This is required by [I-D.ietf-mpls-mna-hdr].
   The Format B LSE can contain arbitrary network actions.

                                    /--C'-- backup
                                   /         egress
                                  /
   Ingress ───A─── LSR ───B─── LSR ───C─── egress
     LER            A           B
                               PLR
                                  \
                                   \--C''-- backup
                                             egress

     Figure 3: Example network topology with protected egress routers.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      MPLS-Label = A                   | TC  |S|    TTL        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      MPLS-Label = B                   | TC  |S|    TTL        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      MPLS-Label = C                   | TC  |S|    TTL        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      MNA-Label=bSPL (TBA)             | TC  |S|    TTL        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Opcode = *|      Data               |R|IHS|S|U| NASL=2|NAL=0|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Opcode = SMEP|  Bypass MPLS Label (BML) = C' |S|  BML  | NAL=1 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1|00            Bypass MPLS Label (BML) = C''|S|     Data=0    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

              Figure 4: Example MPLS stack for above topology.

4.  Security Considerations

   The security issues discussed in [I-D.ietf-mpls-mna-hdr] apply to
   this document.

5.  IANA Considerations

   This document requests that IANA allocates a new codepoint with the
   name "Stateless MPLS Egress Protection" in the "Network Action
   Opcodes Registry".

     +============+==================================+===============+
     | MNA Opcode | Description                      | Reference     |
     +============+==================================+===============+
     | TBA1       | Stateless MPLS Egress Protection | This document |
     +------------+----------------------------------+---------------+

                   Table 1: SMEP Opcode IANA allocation.

6.  References

6.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

6.2.  Informative References

   [I-D.ietf-mpls-mna-hdr]
              Rajamanickam, J., Gandhi, R., Zigler, R., Song, H., and K.
              Kompella, "MPLS Network Action (MNA) Sub-Stack Solution",
              Work in Progress, Internet-Draft, draft-ietf-mpls-mna-hdr-
              08, 30 August 2024,
              <https://datatracker.ietf.org/doc/html/draft-ietf-mpls-
              mna-hdr-08>.

   [RFC8679]  Shen, Y., Jeganathan, M., Decraene, B., Gredler, H.,
              Michel, C., and H. Chen, "MPLS Egress Protection
              Framework", RFC 8679, DOI 10.17487/RFC8679, December 2019,
              <https://www.rfc-editor.org/rfc/rfc8679>.

Authors' Addresses

   Fabian Ihle
   University of Tuebingen
   Tuebingen
   Germany
   Email: fabian.ihle@uni-tuebingen.de


   Michael Menth
   University of Tuebingen
   Tuebingen
   Germany
   Email: michael.menth@uni-tuebingen.de
